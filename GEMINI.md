# π”® PyTarot: AI νƒ€λ΅ λ¦¬λ”© ν”λ«νΌ μ‹μ¤ν… μ„¤κ³„μ„

## π“‹ 1. ν”„λ΅μ νΈ κ°μ” (Project Overview)
Python κΈ°λ° AI νƒ€λ΅ λ¦¬λ”© μ‹μ¤ν…μΌλ΅, **FastAPI**μ™€ **μƒμ„±ν• AI(LLM)**λ¥Ό κ²°ν•©ν•μ—¬ μ‚¬μ©μμ—κ² κ°μΈν™”λ μ΄μ„Έ μƒλ‹΄ μ„λΉ„μ¤λ¥Ό μ κ³µν•©λ‹λ‹¤.

### ν•µμ‹¬ λ©ν‘
- μ‚¬μ©μ μ§λ¬Έ μ…λ ¥ β†’ νƒ€λ΅ μΉ΄λ“ μ„ νƒ(μ•”νΈν•™μ  μ…”ν”) β†’ AI κ°μΈν™” ν•΄μ„ μ κ³µ
- λ‹¨μ λλ¤μ„ λ„μ–΄μ„λ” λ§¥λ½ κΈ°λ°μ μμ—°μ–΄ ν•΄μ„ μ„λΉ„μ¤

---

## π› οΈ 2. κΈ°μ  μ¤νƒ (Technology Stack)
- **Backend:** FastAPI, LangChain, OpenAI/Gemini API
- **Database:** PostgreSQL, SQLAlchemy (ORM)
- **Frontend:** React.js / Flutter (λλ” Streamlit/NiceGUI ν”„λ΅ν† νƒ€μ΄ν•‘)
- **Infrastructure:** Docker, Nginx, Redis (Caching/Session)
- **Libraries:** secrets (λ‚μ), Pillow (μ΄λ―Έμ§€ μ²λ¦¬), Pydantic V2 (κ²€μ¦)

---

## π—οΈ 3. μ‹μ¤ν… μ•„ν‚¤ν…μ² (System Architecture)
- **Client Layer:** μ‚¬μ©μ μΈν„°νμ΄μ¤ λ° κ²°κ³Ό μ‹κ°ν™”
- **API Gateway:** μΈμ¦ λ° Rate Limiting
- **Service Layer:** 
    - `Deck Service`: μ…”ν” λ° λ“λ΅μ° λ΅μ§
    - `Interpretation Service`: LLM ν”„λ΅¬ν”„νΈ μ—”μ§€λ‹μ–΄λ§ λ° μ¤νΈλ¦¬λ° ν•΄μ„
    - `User Service`: μ‚¬μ©μ λ° κΈ°λ΅ κ΄€λ¦¬
- **Data Layer:** PostgreSQL (RDBMS) λ° S3/Local μ΄λ―Έμ§€ μ €μ¥μ†

---

## β™οΈ 4. ν•µμ‹¬ λ΅μ§ (Core Logic)
### 4.1 μ•”νΈν•™μ  μ…”ν” (Cryptographic Shuffle)
`secrets` λ¨λ“μ„ ν™μ©ν•μ—¬ μμΈ΅ λ¶κ°€λ¥ν• Fisher-Yates μ…”ν” μ•κ³ λ¦¬μ¦μ„ κµ¬ν„, μ΄μ„Έμ 'μ§„μ •μ„±' ν™•λ³΄.

### 4.2 μ¤ν”„λ λ“ μ‹μ¤ν… (Spread System)
μΆν‘ κΈ°λ°(Coordinate System)μΌλ΅ μ„¤κ³„λμ–΄ μƒλ΅μ΄ λ°°μ—΄λ²•(μ›μΉ΄λ“, μ“°λ¦¬μΉ΄λ“, μΌν‹± ν¬λ΅μ¤ λ“±)μ„ μ μ—°ν•κ² ν™•μ¥ κ°€λ¥.

### 4.3 AI ν”„λ΅¬ν”„νΈ μ—”μ§€λ‹μ–΄λ§ (AI Prompt Engineering)
LangChainμ„ ν™μ©ν•μ—¬ μ „λ¬Έ νƒ€λ΅ λ¦¬λ”μ νλ¥΄μ†λ‚λ¥Ό μ£Όμ…ν•κ³ , SSE(Server-Sent Events)λ¥Ό ν†µν•΄ μ‹¤μ‹κ°„ μ¤νΈλ¦¬λ° λ‹µλ³€ μ κ³µ.

---

## π—„οΈ 5. λ°μ΄ν„°λ² μ΄μ¤ μ„¤κ³„ (Database Design)
- **Users:** νμ› μ •λ³΄ λ° μ μ„±μ  λ°μ΄ν„°
- **TarotCards:** 78μ¥ μΉ΄λ“ λ©”νƒ€λ°μ΄ν„° (ν‚¤μ›λ“, μ΄λ―Έμ§€, μƒμ§• λ“±)
- **Readings:** λ¦¬λ”© μ„Έμ… λ©”μΈ κΈ°λ΅ (μ§λ¬Έ, AI μ”μ•½)
- **ReadingDetails:** μ„Έμ…λ³„ μ„ νƒλ μΉ΄λ“ λ° μ„μΉ μ •λ³΄

---

## π” 6. μ£Όμ” API μ—”λ“ν¬μΈνΈ
- `POST /api/reading/shuffle`: μ…”ν”λ μ„Έμ… μƒμ„±
- `POST /api/reading/draw`: μΉ΄λ“ μ„ νƒ λ° μ •λ³΄ λ°ν™
- `POST /api/reading/interpret/stream`: AI μ‹¤μ‹κ°„ ν•΄μ„ μ¤νΈλ¦¬λ°
- `GET /api/history/{user_id}`: κ³Όκ±° λ¦¬λ”© κΈ°λ΅ μ΅°ν

---

## π€ 7. κ°λ° λ΅λ“λ§µ (Roadmap)
1. **1λ‹¨κ³„ (κΈ°λ° κµ¬μ¶•):** λ°μ΄ν„°μ…‹(JSON) λ° DB μ—°λ™ (2μ£Ό)
2. **2λ‹¨κ³„ (μ½”μ–΄ λ΅μ§):** μ…”ν” μ—”μ§„ λ° μ¤ν”„λ λ“ μ‹μ¤ν… κ°λ° (2μ£Ό)
3. **3λ‹¨κ³„ (AI μ—°λ™):** LangChain νμ΄ν”„λΌμΈ λ° μ¤νΈλ¦¬λ° κµ¬ν„ (3μ£Ό)
4. **4λ‹¨κ³„ (ν΄λΌμ΄μ–ΈνΈ):** μ›Ή/μ•± UI κ°λ° λ° UX μµμ ν™” (4μ£Ό)
5. **5λ‹¨κ³„ (λ°°ν¬):** Docker/Cloud μΈν”„λΌ κµ¬μ¶• (2μ£Ό)

---

## π“‚ ν„μ¬ ν”„λ΅μ νΈ μƒνƒ (Current Status)
- **λ²„μ „:** v0.1v (μ‚¬μ©μ κ²°μ •μ— λ”°λΌ μ—…λ°μ΄νΈ)
- **λ‚ μ§:** 2026λ…„ 1μ›” 5μΌ
- **μ§„ν–‰ μƒν™©:** 
    - `README.md` λ° `GEMINI.md` κΈ°λ° κµ¬μ¶• μ™„λ£
    - κ°λ° λ¬Έμ„ μ„ΈνΈ(01~09) μ‘μ„± μ™„λ£
    - μ΄κΈ° ν΄λ” κµ¬μ΅° μƒμ„± μ™„λ£
    - νƒ€λ΅ μΉ΄λ“ μ΄λ―Έμ§€ μμ‚°(78μ¥ + λ’·λ©΄) `static/cards/`μ— λ°°μΉ μ™„λ£
    - **λ²„μ „ κ΄€λ¦¬ κ·μΉ™:** λ²„μ „ μ—…λ°μ΄νΈλ” μ‚¬μ©μμ λ…μ‹μ  μ”μ²­ μ‹ μ§„ν–‰ν•¨.

### μƒμ„±λ ν΄λ” κµ¬μ΅°
```
C:\tarot\
β”β”€β”€ app/
β”‚   β”β”€β”€ api/          # μ—”λ“ν¬μΈνΈ λΌμ°ν„°
β”‚   β”β”€β”€ core/         # μ„¤μ •, λ³΄μ•, μ…”ν” μ—”μ§„
β”‚   β”β”€β”€ services/     # λΉ„μ¦λ‹μ¤ λ΅μ§
β”‚   β”β”€β”€ repositories/ # DB μ ‘κ·Ό κ³„μΈµ
β”‚   β”β”€β”€ models/       # SQLAlchemy λ¨λΈ
β”‚   β””β”€β”€ schemas/      # Pydantic μ¤ν‚¤λ§
β”β”€β”€ config/           # μ¤ν”„λ λ“ μ„¤μ • λ“±
β”β”€β”€ Dev_md/           # κ°λ° λ¬Έμ„ λ° λ¦¬ν¬νΈ μ €μ¥μ†
β””β”€β”€ tests/            # ν…μ¤νΈ μ½”λ“
```

---
*λ³Έ λ¬Έμ„λ” `Gemini Markup File Generation Report.html`μ„ λ°”νƒ•μΌλ΅ μƒμ„±λ ν”„λ΅μ νΈ κ°€μ΄λ“λΌμΈμ…λ‹λ‹¤.*
